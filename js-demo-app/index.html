<script>

  'use strict';

  /*
  function outer() {

    let t = 2;

    setTimeout(() => {
      t = 4;
    }, 2000);

    return function() {
      console.log(t);
    }
  }

  const inner = outer();

  inner();

  setTimeout(() => {
    inner();
  }, 4000);

  //console.dir(inner);
  */

  /*
  class Promise {

    constructor(fn) {

      this.resolveFns = [];
      this.rejectFns = [];

      const resolve = (result) => {
        this.resolveFns.forEach(resolveFn => resolveFn(result));
      }

      const reject = (result) => {
        this.rejectFns.forEach(rejectFn => rejectFn(result));
      }

      fn(resolve, reject);
    }

    then(fn) {
      this.resolveFns.push(fn);
    }

    catch(fn) {
      this.rejectFns.push(fn);
    }

  }

  */

  /*
  const p = new Promise((resolve, reject) => {

    console.log('calling setTimeout');
    setTimeout(() => {
      console.log('calling reject');
      reject('a')
    }, 2000);

  });

  p
    .then(result => {
      console.log(result);
    })
    .catch(result => {
      console.log('rejected: ', result);
    });

  console.log('made it here');

  */

  const p1 = () => {
    return new Promise(resolve => {
      setTimeout(() => resolve('a'), 2000);
    });
  };

  const p2 = () => {
    return new Promise(resolve => {
      setTimeout(() => resolve('b'), 1000);
    });
  };

  const p3 = () => {
    return new Promise(resolve => {
      setTimeout(() => resolve('c'), 500);
    });
  };

  /*
  p1()
    .then(result => {
      console.log(result);
      return p2();
    })
    .then(result => {
      console.log(result);
      return p3();
    })
    .then(result => {
      console.log(result);
    });
  */

  /*
  const doSomething = async () => {

    const result1 = await p1();
    console.log(result1);

    const result2 = await p2();
    console.log(result2);

    const result3 = await p3();
    console.log(result3);

  };

  doSomething().then(() => console.log('done'));
  */

  const doAll = async () => {

    const results = await Promise.all([ p1(), p2(), p3() ]);

    console.log('all done: ', results);

  };

  doAll();






</script>